### Nuevos Endpoints - API BoticaSaid
### Descripción: Endpoints para listar productos por proveedor, reportes de lotes y proveedores

@baseUrl = http://localhost:8080
@authToken = Bearer {{token}}

### ============================================================
### 1. LISTAR PRODUCTOS POR PROVEEDOR
### ============================================================

### 1.1 Obtener productos de un proveedor específico
GET {{baseUrl}}/productos/proveedor/1
Authorization: {{authToken}}

### ============================================================
### 2. REPORTES DE LOTES POR RANGO DE FECHAS
### ============================================================

### 2.1 Obtener reporte de lotes agregados en un rango de fechas
# Formato de fechas: ISO 8601 (yyyy-MM-dd o yyyy-MM-ddTHH:mm:ss)
GET {{baseUrl}}/api/reports/lotes?fechaInicio=2025-01-01&fechaFin=2025-12-31
Authorization: {{authToken}}

### 2.2 Obtener reporte de lotes del último mes
GET {{baseUrl}}/api/reports/lotes?fechaInicio=2025-10-15&fechaFin=2025-11-15
Authorization: {{authToken}}

### ============================================================
### 3. REPORTE DE PROVEEDORES CON SUS PRODUCTOS
### ============================================================

### 3.1 Obtener reporte completo de todos los proveedores con sus productos
GET {{baseUrl}}/api/reports/proveedores
Authorization: {{authToken}}

### ============================================================
### 4. EXPORTAR PRODUCTOS POR RANGO DE FECHAS
### ============================================================

### 4.1 Exportar productos creados en un rango de fechas a Excel
# Este endpoint descarga un archivo Excel (.xlsx)
GET {{baseUrl}}/api/reports/productos/export?fechaInicio=2025-01-01&fechaFin=2025-12-31
Authorization: {{authToken}}

### 4.2 Exportar productos del último trimestre
GET {{baseUrl}}/api/reports/productos/export?fechaInicio=2025-08-01&fechaFin=2025-11-15
Authorization: {{authToken}}

### ============================================================
### 5. NUEVO ENDPOINT - RECIBIR ID EN JSON
### ============================================================

### 5.1 Enviar un ID numérico
POST {{baseUrl}}/api/reports/receive-id
Authorization: {{authToken}}
Content-Type: application/json

{
  "id": 1
}

### 5.2 Enviar un ID de tipo string
POST {{baseUrl}}/api/reports/receive-id
Authorization: {{authToken}}
Content-Type: application/json

{
  "id": "test-123"
}

### 5.3 Probar error con campo faltante (debe retornar error 400)
POST {{baseUrl}}/api/reports/receive-id
Authorization: {{authToken}}
Content-Type: application/json

{
  "otro_campo": 123
}

### ============================================================
### 6. NUEVO ENDPOINT - LOTES EN FORMATO JSON
### ============================================================

### 6.1 Obtener reporte de lotes en formato JSON (en lugar de Excel)
GET {{baseUrl}}/api/reports/lotes-json?fechaInicio=2025-01-01&fechaFin=2025-12-31
Authorization: {{authToken}}

### 6.2 Obtener reporte de lotes del último mes en JSON
GET {{baseUrl}}/api/reports/lotes-json?fechaInicio=2025-10-15&fechaFin=2025-11-15
Authorization: {{authToken}}

### 6.3 Probar con fechas inválidas (debe retornar error 400)
GET {{baseUrl}}/api/reports/lotes-json?fechaInicio=invalid-date&fechaFin=2025-12-31
Authorization: {{authToken}}

### ============================================================
### NOTAS:
### ============================================================
# - Todos los endpoints requieren autenticación (Bearer Token)
# - Los reportes de fechas aceptan formato ISO 8601
# - El endpoint de exportación retorna un archivo Excel directamente
# - Los lotes incluyen información del producto asociado
# - El reporte de proveedores incluye la lista completa de productos activos
# - NUEVO: /api/reports/receive-id acepta cualquier tipo de id en el campo "id"
# - NUEVO: /api/reports/lotes-json retorna los mismos datos que /lotes pero en JSON

### ============================================================
### EJEMPLOS DE RESPUESTA ESPERADA
### ============================================================

### Respuesta esperada para /api/reports/lotes:
# [
#   {
#     "productoId": 1,
#     "nombreProducto": "Paracetamol 500mg",
#     "codigoBarras": "123456789",
#     "stockId": 100,
#     "codigoStock": "LOTE-2025-001",
#     "cantidadUnidades": 100,
#     "fechaVencimiento": "2026-12-31",
#     "precioCompra": 5.50,
#     "fechaCreacion": "2025-11-15T10:30:00"
#   }
# ]

### Respuesta esperada para /api/reports/proveedores:
# [
#   {
#     "proveedorId": 1,
#     "ruc": "20123456789",
#     "razonComercial": "Farmacia ABC S.A.C.",
#     "correo": "contacto@farmaciabc.com",
#     "direccion": "Av. Principal 123",
#     "totalProductos": 50,
#     "productos": [
#       {
#         "productoId": 1,
#         "nombre": "Paracetamol 500mg",
#         "codigoBarras": "123456789",
#         "categoria": "Analgésico",
#         "laboratorio": "Lab ABC",
#         "cantidadGeneral": 500
#       }
#     ]
#   }
# ]

### Respuesta esperada para /api/reports/receive-id:
# {
#   "message": "ID recibido correctamente",
#   "id": 1,
#   "received_at": "2025-11-16T02:50:23.123456"
# }

### Respuesta esperada para /api/reports/lotes-json:
# [
#   {
#     "productoId": 1,
#     "nombreProducto": "Paracetamol 500mg",
#     "codigoBarras": "123456789",
#     "concentracion": "500mg",
#     "presentacion": "Tableta",
#     "stockId": 100,
#     "codigoStock": "LOTE-2025-001",
#     "cantidadUnidades": 100,
#     "cantidadInicial": 150,
#     "fechaVencimiento": "2026-12-31",
#     "precioCompra": 5.50,
#     "fechaCreacion": "2025-11-15T10:30:00"
#   }
# ]
